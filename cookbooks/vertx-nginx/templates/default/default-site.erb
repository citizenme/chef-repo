server {
  listen   80;
  listen   443 ssl;
  ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
  ssl_ciphers         ECDH+AESGCM:ECDH+AES256:ECDH+AES128:aNULL:!MD5:!DSS;
  server_name         <%= node['nginx']['server_name'] %>;
  ssl_certificate     <%= "/etc/ssl/certs/" + node['nginx']['server_name'] + ".pem" %>;
  ssl_certificate_key <%= "/etc/ssl/private/" + node['nginx']['server_name'] + ".key" %>;

  access_log  <%= node['nginx']['log_dir'] %>/localhost.access.log;

    location /tosload/ {
     proxy_pass  http://localhost:10080;
     proxy_redirect off;
     proxy_buffering off;
     proxy_set_header        Host            $host;
     proxy_set_header        X-Real-IP       $remote_addr;
     proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
   }

    location /profile/ {
     proxy_pass  http://localhost:10080;
     proxy_redirect off;
     proxy_buffering off;
     proxy_set_header        Host            $host;
     proxy_set_header        X-Real-IP       $remote_addr;
     proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
   }

    location /httpproxy/ {
     proxy_pass  http://localhost:10080;
     proxy_redirect off;
     proxy_buffering off;
     proxy_set_header        Host            $host;
     proxy_set_header        X-Real-IP       $remote_addr;
     proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
   }

    location /tos/ {
     proxy_pass  http://localhost:10080;
     proxy_redirect off;
     proxy_buffering off;
     proxy_set_header        Host            $host;
     proxy_set_header        X-Real-IP       $remote_addr;
     proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
   }

    location /user/ {
     proxy_pass  http://localhost:10080;
     proxy_redirect off;
     proxy_buffering off;
     proxy_set_header        Host            $host;
     proxy_set_header        X-Real-IP       $remote_addr;
     proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
   }

    location /secure/ {
     proxy_pass  http://localhost:10080;
     proxy_redirect off;
     proxy_buffering off;
     proxy_set_header        Host            $host;
     proxy_set_header        X-Real-IP       $remote_addr;
     proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
   }

    location /webapp/ {
     proxy_pass  http://localhost:10180;
     proxy_redirect off;
     proxy_buffering off;
     proxy_set_header        Host            $host;
     proxy_set_header        X-Real-IP       $remote_addr;
     proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
   }

#  location / {
#    root   <%= node['nginx']['default_root'] %>;
#    index  index.html index.htm;
#  }
}
