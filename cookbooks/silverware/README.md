## Overview

The Silverware Cookbook is part of the [Ironfan Pantry](https://github.com/infochimps-labs/ironfan-pantry/) cookbooks. Silverware Cookbook coordinates discovery of services, for example "list all the machines for awesome_webapp, that I might load balance them", and aspects, for example, "list all components that write logs, that I might logrotate them, or that I might monitor the free space on their volumes". 

________________________________________________________________________
# Silverware Chef Cookbook

Cluster orchestration -- coordinates discovery, integration and decoupling of cookbooks

* Cookbook source:   [http://github.com/infochimps-cookbooks/silverware](http://github.com/infochimps-cookbooks/silverware)
* Ironfan tools: [http://github.com/infochimps-labs/ironfan](http://github.com/infochimps-labs/ironfan)
* Homebase (shows cookbook in use): [http://github.com/infochimps-labs/ironfan-homebase](http://github.com/infochimps-labs/ironfan-homebase)



Attributes are scoped by *cookbook* and then by *component*.

* If I declare `announce(:redis)`, it will look in `node[:redis]`.
* If I declare `announce(:hadoop, :namenode)`, it will look in `node[:hadoop]` for cookbook-wide concerns and `node[:hadoop][:namenode]` for component-specific concerns.
* The cookbook scope is always named for its cookbook. Its attributes live in`node[:cookbook_name]`. If everything in the cookbook shares a concern, it sits at cookbook level. So the Hadoop log directory (shared by all its components) is at `(scratch_root)/hadoop/log`.
* If there is only one component, it can be implicitly named for its cookbook. In this case, it is omitted: the component attributes live in `node[:cookbook_name]` (which is the same as the component name).
* If there are multiple components, they will live in `node[:cookbook_name][:component_name]` (eg `[:hadoop][:namenode]` or `[:flume][:master]`.

### Discovery

Allow nodes to discover the location for a given service at runtime, adapting when new services register.

#### Operations:

* register for a service. A timestamp records the last registry.
* discover all chef nodes that have registered for the given service.
* discover the most recent chef node for that service.
* get the 'public_ip' for a service -- the address that nodes in the larger world should use
* get the 'private_ip' for a service -- the address that nodes on the local subnet / private cloud should use
* get the 'private_hostname' for a service -- the hostname that nodes on the local subnet / private cloud should use

#### Implementation

Nodes register a service by calling `announce(<service>[,<component>])`, which adds a hash to node[:announces][<service>][<component>], containing 'timestamp' (the time of registry) and other metadata passed in. Nodes discover services by calling `discover(<service>[,<component>[,<realm>]])`, where realm is the scope of the discovery (the current cluster, by default).

## Recipes 

* `default`                  - Base configuration for silverware

## Integration

Supports platforms: Debian and Ubuntu



## Attributes

* `[:silverware][:conf_dir]`            -  (default: "/etc/silverware")
* `[:silverware][:log_dir]`             -  (default: "/var/log/silverware")
* `[:silverware][:home_dir]`            -  (default: "/etc/silverware")
* `[:silverware][:user]`                -  (default: "root")
* `[:users][:root][:primary_group]`     -  (default: "root")

## License and Author

Author::                Philip (flip) Kromer - Infochimps, Inc (<coders@infochimps.com>)
Copyright::             2011, Philip (flip) Kromer - Infochimps, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

> readme generated by [ironfan](http://github.com/infochimps-labs/ironfan)'s cookbook_munger
